# 完整使用示例和案例

本文档包含实际使用示例和常见场景处理。

## 示例 1: 北京三人烤肉聚餐

### 用户输入
```
"我们三个人在来广营、霍营、朱辛庄，想找个中间地点吃烤肉"
```

### 执行流程

#### Step 1: 参数收集
```
origin_locations: ["来广营", "霍营", "朱辛庄"]
food_preference: "烤肉"
city: "北京"
transportation: ["驾车", "地铁"]
```

#### Step 2: 地理编码
```
来广营:  (116.439192, 40.027183) - 北京市朝阳区
霍营:    (116.368207, 40.076214) - 北京市昌平区
朱辛庄:  (116.306005, 40.091268) - 北京市昌平区
```

#### Step 3: 计算中心点
```
中心经度 = (116.439192 + 116.368207 + 116.306005) / 3 = 116.371135
中心纬度 = (40.027183 + 40.076214 + 40.091268) / 3 = 40.064888
中心点: (116.371135, 40.064888) → "北京海淀区"
```

#### Step 4: 计算出行时间

**驾车方案**:
```
张三(来广营 → 海淀):  11.4km, 19.5分钟
李四(霍营 → 海淀):    2.1km, 6.2分钟
王五(朱辛庄 → 海淀):  9.3km, 17.4分钟

平均时间: 14.4分钟
方差: 33.5 ✅ 非常理想
最大差: 13.3分钟 ✅ 可接受
```

**公交/地铁方案**:
```
张三: 约73分钟 (公交617路 + 步行)
李四: 约33分钟 (公交478路 + 步行)
王五: 约52分钟 (公交617路 + 步行)

平均时间: 52.7分钟
方差: 大
最大差: 40分钟 ❌ 差异太大，不推荐
```

**推荐**: 驾车方案最优

#### Step 5: 搜索烤肉餐厅
```
关键词: "烤肉"
搜索结果: 20+ 家餐厅
```

#### Step 6: 获取前10家餐厅详情

| 排名 | 餐厅名称 | 评分 | 评论数 | 人均 | 地址 |
|-----|---------|------|--------|------|------|
| 1 | 胡大饭馆(簋街三店) | 4.9 | 2340 | ¥137 | 东直门内大街284号 |
| 2 | 刘记炙子烤肉(虎坊桥店) | 4.8 | 1850 | ¥112 | 腊竹胡同85号 |
| 3 | 汉巴味德(银座和谐广场) | 4.8 | 1200 | ¥115 | 万丰路68号 |
| ... | ... | ... | ... | ... | ... |

#### Step 7: 按综合评分排序 (TOP 5)

```
1. 胡大饭馆 - 评分4.9 ⭐⭐⭐⭐⭐
2. 刘记炙子烤肉 - 评分4.8 ⭐⭐⭐⭐
3. 汉巴味德 - 评分4.8 ⭐⭐⭐⭐
4. 清真·鸦儿李记 - 评分4.8 ⭐⭐⭐⭐
5. 作作烧肉(中关村) - 评分4.7 ⭐⭐⭐⭐
```

#### Step 8: 到各餐厅的出行时间

**首选: 胡大饭馆(簋街三店)**
```
张三(来广营):  约25分钟
李四(霍营):    约35分钟
王五(朱辛庄):  约40分钟

最晚到达: 40分钟
建议时间窗口: 30-45分钟
```

#### 最终推荐

```
✅ 推荐地点: 东直门簋街(胡大饭馆)
✅ 推荐方式: 驾车
✅ 约定时间: 14:30 聚餐

出发时间:
  张三: 14:10 出发(20分钟到达)
  李四: 14:20 出发(最近,只需10分钟)
  王五: 14:00 出发(最远,需30分钟)

餐厅信息:
  - 评分: 4.9/5.0 (很高!)
  - 人均: ¥137/人
  - 特色: 蝎子烤肉(招牌菜)
  - 营业: 11:00-01:00
```

---

## 示例 2: 上海5人日料聚餐

### 用户输入
```
"5个人分别在浦东、浦西、虹口、松江、嘉定，想吃日料，要平价点的"
```

### 参数收集
```
locations: ["浦东", "浦西", "虹口", "松江", "嘉定"]
food_preference: "日料"
budget_range: "¥50-100/人"
city: "上海"
```

### 处理注意

**问题 1**: 5个地点跨度太大（从浦东到嘉定可能30km+）

**解决方案**:
```
1. 计算中心点 → 可能在陆家嘴
2. 检查方差 → 预期会很大（50分钟以上差异）
3. 提示用户:
   "5个人分布很分散。建议选择3个最重要的地点,
   或者考虑分成两个地点分别聚餐。"
4. 生成多个方案供选择
```

**方案A: 以3个核心地点为主**
```
去掉松江和嘉定,只用浦东、浦西、虹口
→ 新的中心点在黄浦区
→ 时间相似度大幅提升
```

**方案B: 两地分别聚餐**
```
浦东/浦西 → 陆家嘴日料区
虹口/松江/嘉定 → 静安日料区
```

### 日料餐厅搜索结果

```
关键词搜索: "日料"
结果示例:
  - 吉野家(平价连锁)
  - 一兰拉面(平价面馆)
  - 米季日餐(中档)
  - 磨房日本料理(高档)
```

### 按预算过滤

```
平价选项 (¥50-80/人):
  1. 吉野家 - 评分4.3 - ¥68/人
  2. 一兰拉面 - 评分4.5 - ¥72/人
  3. 牛丼店 - 评分4.2 - ¥55/人

中档选项 (¥80-120/人):
  1. 米季日餐 - 评分4.6 - ¥95/人
  2. 松寿司 - 评分4.7 - ¥110/人

→ 推荐平价选项给用户(符合预算)
```

---

## 示例 3: 北京2人周末咖啡约见

### 用户输入
```
"我在国贸,朋友在798艺术区,周末想找个咖啡厅见面"
```

### 参数收集
```
locations: ["国贸", "798艺术区"]
food_preference: "咖啡厅" 或 "咖啡"
city: "北京"
meeting_time: "周六 14:00"
```

### 处理特殊情况

**问题**: 只有2个地点,都是很知名的商圈

**解决方案**:
```
1. 地理编码:
   国贸: (116.461725, 39.904575)
   798: (116.472568, 39.934982)

2. 中心点:
   (116.467147, 39.919779) → 在顺义区附近

3. 问题: 中心点在两个地点之间,但可能不是实际咖啡厅集中地

4. 改进策略:
   - 在"国贸和798之间的地点"搜索咖啡厅
   - 或者建议在其中一个地点(如798,更有文艺氛围)
```

### 咖啡厅推荐

```
在国贸周边:
  1. Luckin Coffee - 评分4.4 - 到国贸:1分钟,到798:25分钟
  2. 蛙咖啡 - 评分4.6 - 到国贸:3分钟,到798:20分钟

在798周边:
  1. 798咖啡厅 - 评分4.5 - 到798:2分钟,到国贸:22分钟
  2. 木空间咖啡 - 评分4.7 - 到798:5分钟,到国贸:18分钟

在中间位置:
  1. 朝阳公园咖啡厅 - 评分4.3 - 到国贸:12分钟,到798:12分钟

推荐: 朝阳公园咖啡厅 (时间最均衡)
```

---

## 示例 4: 处理无法地理编码的地址

### 用户输入
```
"我们在北三环、西边那个商业街、南四环附近,想吃火锅"
```

### 问题诊断

```
"北三环" → 可以编码(返回北京北三环)
"西边那个商业街" → 太模糊!无法编码
"南四环附近" → 可以编码(返回北京南四环)
```

### 处理流程

```
1. 检测到"西边那个商业街"无法编码
2. 向用户询问:
   "请提供'西边商业街'的具体位置或名称,
    例如:
    - 具体街道名
    - 最近的地铁站或地标
    - 商业街的正式名称"

3. 用户补充: "西客站附近的莲花池东路"
4. 重新编码: "西客站莲花池东路" ✅ 成功
```

### 继续推荐流程

```
编码完成后,继续正常的聚餐推荐流程
```

---

## 示例 5: 同时支持多家分店的餐厅

### 用户输入
```
"我们想吃海底捞,最近哪家店最方便?"
```

### 处理方法

```
1. 搜索关键词: "海底捞"
2. 返回多个结果:
   - 海底捞(朝阳大悦城店) - 东三环
   - 海底捞(中关村大融城店) - 海淀
   - 海底捞(三里屯SOHO店) - 东三环
   - ...

3. 计算每家店的综合评分:
   (所有人到该店的平均时间、距离中心点)

4. 推荐最优的一家:
   "建议去 海底捞(朝阳大悦城店),
    三人平均到达时间最短"
```

---

## 示例 6: 处理营业时间冲突

### 用户输入
```
"想吃饭,但我只在晚上10点以后有时间"
```

### 处理方法

```
1. 用户指定聚餐时间: 22:00

2. 搜索餐厅后,检查营业时间:
   - 胡大饭馆: 11:00-01:00 ✅ (营业中)
   - 刘记炙子烤肉: 11:00-22:30 ✅ (营业中)
   - 汉巴味德: 11:00-21:30 ❌ (已关闭)

3. 过滤掉已关闭的餐厅

4. 提示用户:
   "晚上10点只有部分餐厅营业,
    特别是独立饭店,建议提前预订"
```

---

## 示例 7: 预算过滤

### 用户输入
```
"3个人吃饭,每人最多花¥100"
```

### 处理方法

```
1. 收集预算信息: budget_max = ¥100/人

2. 搜索餐厅后,按人均消费过滤:
   餐厅A: ¥68/人 ✅ 符合
   餐厅B: ¥95/人 ✅ 符合
   餐厅C: ¥150/人 ❌ 超预算

3. 只推荐符合预算的餐厅:
   "根据¥100/人的预算,
    为您推荐4家合适的餐厅"
```

---

## 示例 8: 特殊饮食需求

### 用户输入
```
"有人吃素,有人不吃海鲜,最好是素食友好的餐厅"
```

### 处理方法

```
1. 收集特殊需求:
   - dietary_restrictions: ["素食", "无海鲜"]

2. 搜索时使用修饰关键词:
   "烤肉 素食" 或 "素食烤肉"
   → 查找有素食选项的烤肉店

3. 获取餐厅详情后,检查评价:
   查看评价中是否提到"素食"、"素菜"

4. 推荐时标注:
   "该餐厅有素食选项,
    推荐菜品: 素烤串、蔬菜卷"
```

---

## 最佳实践总结

### 参数收集要点

- ✅ 至少2个出发地,最多10个(超过5个建议分组)
- ✅ 美食偏好要具体(不要太模糊)
- ✅ 城市名称必须提供(跨城市聚餐需明确)
- ✅ 特殊需求提前说明(素食、预算、时间)

### 异常情况处理

| 情况 | 处理方法 |
|-----|--------|
| 无法编码地址 | 请用户提供更详细信息或地标 |
| 分布过分散 | 建议分组或选择核心地点 |
| 时间差异大 | 生成多个方案,让用户选择 |
| 餐厅不足 | 扩大搜索范围或放宽美食要求 |
| 无法规划路线 | 检查坐标有效性,切换地图服务 |

### 推荐生成要点

- ✅ 明确显示每人的出行时间
- ✅ 突出时间相似度评分
- ✅ 列出TOP 5餐厅(不要太多)
- ✅ 提供具体的出发时间建议
- ✅ 标注支付方式和营业时间
- ✅ 提供实用的出行建议(停车、预订)

